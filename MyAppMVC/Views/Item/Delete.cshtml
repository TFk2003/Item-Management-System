@model MyAppMVC.Models.Item
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
	ViewData["Title"] = "Delete Item";
}

<div class="container-fluid">
	<div class="row">
		<div class="col-md-6 mx-auto">
			<div class="card border-danger">
				<div class="card-header bg-danger text-white">
					<h4><i class="bi bi-exclamation-triangle"></i> Delete Item</h4>
				</div>
				<div class="card-body">
					<div class="alert alert-danger">
						<h5><i class="bi bi-exclamation-octagon"></i> Warning!</h5>
						<p class="mb-0">You are about to delete a item. This action cannot be undone.</p>
					</div>
					<div class="card mb-3">
						<div class="card-body">
							<div class="d-flex align-items-center mb-3">
								<div class="category-delete-color me-3"
									 style="background-color: @GetCategoryColor(Model.Id); width: 30px; height: 30px; border-radius: 50%;"></div>
								<div>
									<h5 class="mb-0">@Model.Name</h5>
									<small class="text-muted">ID: @Model.Id</small>
								</div>
							</div>
							<dl class="row mb-0">
								<dt class="col-sm-4">Description</dt>
								<dd class="col-sm-8">@(string.IsNullOrEmpty(Model.Description) ? "-" : Model.Description)</dd>

								<dt class="col-sm-4">Price</dt>
								<dd class="col-sm-8">@(Model.Price == 0 ? "-" : Model.Price.ToString("N2"))</dd>

								<dt class="col-sm-4">Stock Quantity</dt>
								<dd class="col-sm-8">@(Model.StockQuantity == 0 ? "-" : Model.StockQuantity.ToString("N2"))</dd>

								<dt class="col-sm-4">Reorder Level</dt>
								<dd class="col-sm-8">@(Model.ReorderLevel== 0 ? "-" : Model.ReorderLevel.ToString("N2"))</dd>

								<dt class="col-sm-4">SKU</dt>
								<dd class="col-sm-8">@(string.IsNullOrEmpty(Model.SKU) ? "-" : Model.SKU)</dd>

								<dt class="col-sm-4">Manufacturer</dt>
								<dd class="col-sm-8">@(string.IsNullOrEmpty(Model.Manufacturer) ? "-" : Model.Manufacturer)</dd>

								<dt class="col-sm-4">Category</dt>
								<dd class="col-sm-8">@(Model.Category != null ? Model.Category.Name : "-")</dd>

								<dt class="col-sm-4">Supplier</dt>
								<dd class="col-sm-8">@(Model.Supplier != null ? Model.Supplier.CompanyName : "-")</dd>

								<dt class="col-sm-4">Serial Number</dt>
								<dd class="col-sm-8">@(Model.SerialNumber != null ? "-" : Model.SerialNumber)</dd>

								<dt class="col-sm-4">Status</dt>
								<dd class="col-sm-8">
									<span class="badge @(Model.IsActive ? "bg-success" : "bg-secondary")">
										@(Model.IsActive ? "Active" : "Inactive")
									</span>
								</dd>

								<dt class="col-sm-4">Created</dt>
								<dd class="col-sm-8">@Model.CreatedDate.ToString("MMM dd, yyyy")</dd>

								<dt class="col-sm-4">Clients Count</dt>
								<dd class="col-sm-8">
									<span class="badge bg-info">@(Model.ItemClients?.Count ?? 0) clients</span>
								</dd>
							</dl>
						</div>
					</div>
					@if (Model.ItemClients != null && Model.ItemClients.Any())
					{
						<div class="alert alert-warning">
							<h6><i class="bi bi-info-circle"></i> Impact Analysis</h6>
							<ul class="mb-0">
								<li><strong>@Model.ItemClients.Count clients</strong> are linked to this items</li>
								<li>These items will lose their clients linkage</li>
								<li>Consider reassigning clients before deletion</li>
							</ul>
						</div>
					}
					<form asp-action="Delete">
						<input type="hidden" asp-for="Id" />

						<div class="mb-3">
							<label class="form-label">
								<i class="bi bi-shield-check"></i> Confirm Deletion
							</label>
							<div class="form-check">
								<input class="form-check-input" type="checkbox" id="confirmDelete" required>
								<label class="form-check-label" for="confirmDelete">
									I understand that this action cannot be undone
								</label>
							</div>
						</div>
						<div class="d-flex justify-content-between">
							<a asp-action="Index" class="btn btn-outline-secondary">
								<i class="bi bi-arrow-left"></i> Cancel
							</a>
							<button type="submit" class="btn btn-danger" id="deleteBtn" disabled>
								<i class="bi bi-trash"></i> Delete Item
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>

@functions {
	string GetCategoryColor(int id)
	{
		var colors = new[] { "#3498db", "#2ecc71", "#e74c3c", "#f39c12", "#9b59b6", "#1abc9c", "#d35400", "#34495e" };
		return colors[id % colors.Length];
	}
}

@section Scripts {
	<script>
		$(document).ready(function() {
			// Enable delete button only when confirmed
			$('#confirmDelete').change(function() {
				$('#deleteBtn').prop('disabled', !$(this).is(':checked'));
			});

			// Double-check before submitting
			$('#deleteBtn').click(function(e) {
				if (!confirm('Are you absolutely sure you want to delete this item?')) {
					e.preventDefault();
				}
			});
		});
	</script>
}